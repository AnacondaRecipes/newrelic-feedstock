{% set name = "newrelic" %}
{% set version = "5.16.1.146" %}

package:
  name: {{ name }}
  version: {{ version }}

source:
  url: https://pypi.io/packages/source/{{ name[0] }}/{{ name }}/{{ name }}-{{ version }}.tar.gz
  sha256: 339b5762fc8dd75bc432971b6b2d659f7c82a89b0db0dbb37eac81bca3767772

build:
  number: 0
  script: {{ PYTHON }} -m pip install . --no-deps -vv
  entry_points:
    - newrelic-admin = newrelic.admin:main

requirements:
  build:
    - {{ compiler('c') }}
  host:
    - pip
    - python
    - setuptools_scm >=3.2,<4
  run:
    - python

test:
  requires:
    - python
    - pip
  imports:
    - newrelic
  commands:
    - python -m pip check
    - newrelic-admin help  # [unix]
    - conda inspect linkages -p $PREFIX $PKG_NAME  # [not win]
    - conda inspect objects -p $PREFIX $PKG_NAME  # [osx]

about:
  home: https://newrelic.com/docs/python/new-relic-for-python
  license: Apache-2.0
  license_file:
    - LICENSE
    - THIRD_PARTY_NOTICES.md
    - newrelic/packages/wrapt/LICENSE
    - newrelic/packages/urllib3/LICENSE.txt
  summary: New Relic Python Agent
  dev_url: https://github.com/newrelic/newrelic-python-agent
  description: |
    The newrelic package instruments your application for performance
    monitoring and advanced performance analytics with New Relic.

    Pinpoint and solve Python application performance issues down to the line
    of code. New Relic APM is the only tool youâ€™ll need to see everything in
    your Python application, from the end user experience to server monitoring.
    Trace problems down to slow database queries, slow 3rd party APIs and web
    services, caching layers, and more. Monitor your app in a production
    environment and make sure your app can stand a big spike in traffic by
    running scalability reports.

extra:
  recipe-maintainers:
    - bollwyvl
